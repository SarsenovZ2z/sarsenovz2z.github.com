<html>
    <head>
        <meta charset="utf-8"/>
        <title>Sarsenov N.</title>
        <meta property="og:image" content="https://www.thoughtco.com/thmb/skYYjbimV2cbDMpG8pBQj3Jt8ss=/768x0/filters:no_upscale():max_bytes(150000):strip_icc()/skyrocket-collage-background-571127103-57752ea85f9b585875694d3c.jpg" />
        <style>
            * {
                padding: 0;
                margin: 0;
            }
            html {
                min-width: 100%;
                min-height: 100%;
            }
            #wrapper {
                position: relative;
                top: 50%;
                left: 50%;
                width: 100%;
                height: 100%;
                background-color: transparent;
                transform: translate(-50%, -50%);
            }
            canvas {
                position: relative;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
                z-index: -1;
                background-color: black;
            }
            img {
                display: none;
            }

        </style>
    </head>
    <body>
        <img src = "https://images.alphacoders.com/898/thumb-1920-898735.jpg"/>
        <div id="wrapper">
            <canvas class="particles"></canvas>
        </div>
        <script>
            var canvas;
            var ctx;
            var animatable = [];

            window.addEventListener("DOMContentLoaded", function()
            {
                init();
            });

            function init()
            {
                canvas = document.getElementsByClassName("particles")[0];
                canvas.width = document.getElementById("wrapper").offsetWidth;
                canvas.height = document.getElementById("wrapper").offsetHeight;
                ctx = canvas.getContext("2d");
                animatable.push(new Particle());
                animate();
            }

            function animate()
            {
                ctx.save();
                ctx.beginPath();
                ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                for (var i = 0;i<animatable.length;++i)
                {
                    if (animatable[i].destroy)
                    {
                        animatable[i].explode();
                        animatable.splice(i, 1);
                        i--;
                    }
                    else
                    {
                        animatable[i].draw();
                    }
                }
                ctx.restore();
                if (Rand(0, 200) >= 197)
                {
                    animatable.push(new Particle());
                }
                window.requestAnimationFrame(animate);
            }


            function Particle(x = Rand(150, canvas.width-150), y = canvas.height+100, speed_x = Rand(-5, 5), speed_y = Rand(40, 50), radius = Rand(0.1, 0.5), color = getRandomColor(), eHeight = canvas.height*Rand(0.2, 0.7))
            {
                this.x = x;
                this.y = y;
                this.speed_x = speed_x;
                this.speed_y = speed_y;
                this.radius = radius;
                this.color = color;
                this.explodeHeight = eHeight;
                // this.next = Rand(0, 2, true)==1?new Particle(x, y, Rand(-2, 2), speed_y+Rand(-1, 1), radius, getRandomColor(), eHeight+Rand(-20, 20)):false;
                this.destroy = false;

                this.explode = function()
                {
                    animatable.push(new fractions(this.x, this.y, this.color));
                    // if (this.next)
                    // {
                    //     window.setTimeout(this.registerNext.bind(null, this.next), 2500+Rand(0, 500));
                    // }
                }

                // this.registerNext = function(p)
                // {
                //     animatable.push(p);
                // }

                this.update = function()
                {
                    this.x+=this.speed_x;
                    this.y-=this.speed_y;
                    this.speed_y-=1;
                    if (this.y<=this.explodeHeight || this.old_y-this.y<5)
                    {
                        this.destroy = true;
                    }
                }

                this.draw = function()
                {
                    this.old_x = this.x;
                    this.old_y = this.y;
                    this.update();

                    ctx.save();

                    ctx.beginPath();
                    ctx.fillStyle = this.color;
                    ctx.arc(this.x, this.y, this.radius, 0, 2*Math.PI);
                    ctx.fill();

                    ctx.beginPath();
                    ctx.strokeStyle = this.color;
                    ctx.lineWidth = 2*this.radius;
                    ctx.moveTo(this.old_x, this.old_y);
                    ctx.lineTo(this.x, this.y);
                    ctx.stroke();

                    ctx.restore();
                }
            }

            function fractions(x, y, color=getRandomColor(), speed = Rand(15, 25), maxSize = Rand(250, 350))
            {
                this.x = x;
                this.y = y;
                this.size = 0;
                this.radius = 0.1;
                this.maxSize = maxSize;
                this.speed = speed;
                this.color = color;
                this.destroy = false;

                this.explode = function()
                {

                }

                this.update = function()
                {
                    this.size+=this.speed;
                    this.speed-=this.speed/8;
                    if (this.size>=this.maxSize || this.speed<=0.5)
                    {
                        this.destroy = true;
                    }
                }

                this.draw = function()
                {
                    this.oldSize = this.size;
                    this.update();
                    for (var j = 0;j<360;j++)
                    {
                        let i = Rand(0, 360, true);
                        this.radius = 1/(2-Math.sin(j));
                        // let old_x = this.x+this.oldSize*Math.cos(i)*Math.cos(j);
                        // let old_y = this.y+this.oldSize*Math.sin(i)*Math.cos(j);
                        ctx.save();
                        ctx.beginPath();
                        ctx.fillStyle = this.color;
                        ctx.arc(this.x+this.size*Math.cos(i)*Math.cos(j), this.y+this.size*Math.sin(i)*Math.cos(j), this.radius, 0, 2*Math.PI);
                        ctx.fill();
                        // ctx.beginPath();
                        // ctx.strokeStyle = getRandomColor();
                        // ctx.lineWidth = 2*this.radius;
                        // ctx.moveTo(old_x, old_y);
                        // ctx.lineTo(x, y);
                        // ctx.stroke();
                        ctx.restore();
                    }
                }
            }



            function Rand(min, max, floor=false)
            {
                if (floor)
                    return Math.floor(1+Math.random() * (max - min) + min);
                return Math.random() * (max - min) + min;
            }

            function getRandomColor()
            {
                return "rgb("+Rand(100, 255, true)+", "+Rand(100, 255, true)+", "+Rand(100, 255, true)+")";
            }

        </script>
    </body>
</html>
